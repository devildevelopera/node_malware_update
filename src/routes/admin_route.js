const router = require('express').Router();
const AdminController = require('../controller/admin_controller');
const AsnController = require('../controller/asn_controller');

router.use((req, res, next) => {
    // if (req.session.isAdmin){
    next();
    // } else {
    //     res.status(401).json('unauthorized');
    // }
})

router.route('/addAdminUser')
    .post(AdminController.addNewMorderateAdmin);

router.route('/checkAdminUser')
    .post(AdminController.checkAdminUser);

router.route('/updateAdminUser')
    .put(AdminController.updateAdmin);

router.route('/getAllModerateUser')
    .get(AdminController.getAllModerateUser);

router.route('/deleteAdmin/:id')
    .delete(AdminController.deleteAdmin);

router.route('/malwares')
    .get(AdminController.getAllMalware);

router.route('/malware/:id')
    .get(AdminController.getMalware);

router.route('/addNewMalware')
    .post(AsnController.addNewMalware);

router.route('/updateMalware')
    .put(AdminController.updateMalware);

router.route('/malwareDelete/:id')
    .delete(AdminController.deleteSubmitMalware);

router.route('/uploadCsv')
    .post(AdminController.importCSV);
module.exports = router;